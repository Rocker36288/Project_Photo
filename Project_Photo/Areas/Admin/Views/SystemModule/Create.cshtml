@model Project_Photo.Models.UserSystemModule
@{
    ViewData["Title"] = "新增系統模組";
}

@section Styles {
    <style>
        .form-label {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .required::after {
            content: " *";
            color: #d63939;
        }

        .form-text {
            font-size: 0.875rem;
            color: #64748b;
        }
    </style>
}

<div class="page-header d-print-none">
    <div class="container-xl">
        <div class="row g-2 align-items-center">
            <div class="col">
                <h2 class="page-title">
                    新增系統模組
                </h2>
            </div>
            <div class="col-auto ms-auto d-print-none">
                <div class="btn-list">
                    <a asp-action="Index" class="btn btn-secondary">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                            <path d="M5 12l14 0" />
                            <path d="M5 12l6 6" />
                            <path d="M5 12l6 -6" />
                        </svg>
                        返回列表
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="page-body">
    <div class="container-xl">
        <div class="row row-cards">
            <div class="col-12">
                <form asp-action="Create" method="post">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">系統模組資訊</h3>
                        </div>
                        <div class="card-body">
                            @if (!ViewData.ModelState.IsValid)
                            {
                                <div class="alert alert-danger alert-dismissible" role="alert">
                                    <div class="d-flex">
                                        <div>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon alert-icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                <circle cx="12" cy="12" r="9" />
                                                <line x1="12" y1="8" x2="12" y2="12" />
                                                <line x1="12" y1="16" x2="12.01" y2="16" />
                                            </svg>
                                        </div>
                                        <div>
                                            <h4 class="alert-title">發生錯誤</h4>
                                            <div class="text-muted">
                                                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <a class="btn-close" data-bs-dismiss="alert" aria-label="close"></a>
                                </div>
                            }

                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label asp-for="SystemCode" class="form-label required">系統代碼</label>
                                        <input asp-for="SystemCode" class="form-control" placeholder="例如: PHOTO_SYSTEM" maxlength="50" />
                                        <small class="form-text">請使用英文大寫和底線,建議格式: XXX_SYSTEM</small>
                                        <span asp-validation-for="SystemCode" class="text-danger"></span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label asp-for="SystemName" class="form-label required">系統名稱</label>
                                        <input asp-for="SystemName" class="form-control" placeholder="例如: 照片分類系統" maxlength="100" />
                                        <small class="form-text">請輸入系統的中文名稱</small>
                                        <span asp-validation-for="SystemName" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label asp-for="SystemDescription" class="form-label">系統說明</label>
                                <textarea asp-for="SystemDescription" class="form-control" rows="4" placeholder="請輸入系統的功能說明..." maxlength="200"></textarea>
                                <small class="form-text">最多 200 個字元,用於說明此系統的主要功能</small>
                                <span asp-validation-for="SystemDescription" class="text-danger"></span>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">狀態</label>
                                <div>
                                    <label class="form-check form-check-inline">
                                        <input asp-for="IsActive" class="form-check-input" type="radio" value="true" checked />
                                        <span class="form-check-label">啟用</span>
                                    </label>
                                    <label class="form-check form-check-inline">
                                        <input asp-for="IsActive" class="form-check-input" type="radio" value="false" />
                                        <span class="form-check-label">停用</span>
                                    </label>
                                </div>
                                <small class="form-text">停用後,此系統的角色和權限將無法使用</small>
                            </div>
                        </div>
                        <div class="card-footer text-end">
                            <div class="d-flex">
                                <a asp-action="Index" class="btn btn-link">取消</a>
                                <button type="submit" class="btn btn-primary ms-auto">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <line x1="12" y1="5" x2="12" y2="19" />
                                        <line x1="5" y1="12" x2="19" y2="12" />
                                    </svg>
                                    建立系統模組
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- 說明卡片 -->
        <div class="row row-cards mt-3">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                <circle cx="12" cy="12" r="9" />
                                <line x1="12" y1="8" x2="12.01" y2="8" />
                                <polyline points="11 12 12 12 12 16 13 16" />
                            </svg>
                            系統模組說明
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h4 class="mb-3">什麼是系統模組?</h4>
                                <p class="text-muted">
                                    系統模組是整個應用程式的核心分類單位。每個系統模組代表一個獨立的功能區塊,
                                    例如「照片分類系統」、「社群網路系統」、「影片平台系統」等。
                                </p>
                                <p class="text-muted">
                                    系統模組用於組織和管理相關的角色類型和權限,讓權限控制更清晰、更容易維護。
                                </p>
                            </div>
                            <div class="col-md-6">
                                <h4 class="mb-3">命名建議</h4>
                                <ul class="text-muted">
                                    <li><strong>系統代碼:</strong> 使用英文大寫和底線,例如: <code>PHOTO_SYSTEM</code>、<code>SOCIAL_SYSTEM</code></li>
                                    <li><strong>系統名稱:</strong> 使用中文清楚描述,例如: 「照片分類系統」、「社群網路系統」</li>
                                    <li><strong>系統說明:</strong> 簡單描述此系統的主要功能和用途</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script>
        // 表單驗證提示
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.querySelector('form');
            const systemCodeInput = document.querySelector('#SystemCode');
            const systemNameInput = document.querySelector('#SystemName');

            // 系統代碼格式驗證
            if (systemCodeInput) {
                systemCodeInput.addEventListener('input', function (e) {
                    // 自動轉換為大寫
                    e.target.value = e.target.value.toUpperCase();

                    // 只允許英文字母、數字和底線
                    e.target.value = e.target.value.replace(/[^A-Z0-9_]/g, '');
                });
            }

            // 表單提交前確認
            form.addEventListener('submit', function (e) {
                const systemCode = systemCodeInput.value.trim();
                const systemName = systemNameInput.value.trim();

                if (!systemCode || !systemName) {
                    e.preventDefault();
                    alert('請填寫必填欄位');
                    return false;
                }
            });
        });
    </script>
}
